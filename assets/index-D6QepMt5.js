import{r as o,j as e}from"./index-ChAW1Y76.js";function k({title:i,description:a,id:c,onDelete:p,onUpdate:l}){const[d,n]=o.useState(!1),[h,x]=o.useState(i||""),[u,j]=o.useState(a||"");o.useEffect(()=>{x(i),j(a)},[i,a]);const g=()=>{h.trim()!==""&&u.trim()!==""&&(l(c,{title:h,description:u}),n(!1))};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"task",children:[e.jsxs("div",{className:"info",children:[e.jsx("h3",{children:i}),e.jsx("p",{children:a})]}),e.jsxs("div",{className:"buttons",children:[e.jsx("button",{className:"button",onClick:()=>p(c),children:"🗑️ Delete"}),e.jsx("button",{className:"button",onClick:()=>n(!0),children:"Update"})]}),d&&e.jsx("div",{className:"modal",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("h3",{children:"Task Edit"}),e.jsx("input",{type:"text",value:h,onChange:m=>x(m.target.value)}),e.jsx("textarea",{value:u,onChange:m=>j(m.target.value)}),e.jsxs("div",{className:"modal-buttons",children:[e.jsx("button",{onClick:g,children:"Save"}),e.jsx("button",{onClick:()=>n(!1),children:"Cancel"})]})]})})]})})}function v({title:i,description:a,setTitle:c,setDescription:p,addTask:l}){const d=n=>{n.preventDefault(),l()};return e.jsx(e.Fragment,{children:e.jsxs("form",{className:"form",onSubmit:d,children:[e.jsx("input",{type:"text",placeholder:"Title",value:i,onChange:n=>c(n.target.value)}),e.jsx("input",{type:"text",placeholder:"Description",value:a,onChange:n=>p(n.target.value)}),e.jsx("button",{onClick:d,children:"Post"})]})})}const f="https://cruc.vercel.app/api/tasks";function N(){const[i,a]=o.useState([]),[c,p]=o.useState(!0),[l,d]=o.useState(null),[n,h]=o.useState(""),[x,u]=o.useState("");o.useEffect(()=>{(async()=>{try{const s=await fetch(f);if(!s.ok)throw new Error(`Response status: ${s.status}`);const r=await s.json();a(r)}catch(s){d(s.message)}finally{p(!1)}})()},[]);const j=async()=>{if(n)try{const t=await fetch(`${f}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:n,description:x})});if(!t.ok)throw new Error("Error to post task");const s=await t.json();a(r=>r.some(w=>w._id===s._id)?r:[...r,s]),h(""),u("")}catch(t){console.log("Error:",t)}},g=async t=>{try{if(!(await fetch(`${f}/${t}`,{method:"DELETE"})).ok)throw new Error("Error al eliminar la tarea");a(r=>r.filter(E=>E._id!==t))}catch(s){console.error("Error:",s)}},m=async(t,s)=>{try{const r=await fetch(`${f}/${t}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok)throw new Error("Error al actualizar la tarea");const E=await r.json();a(w=>w.map(y=>y._id===t?{...y,...s}:y))}catch(r){console.error("Error",r.message)}};return c?e.jsx("p",{children:"Loading..."}):l?e.jsxs("p",{children:["Error: ",l]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"section-tasks",children:[e.jsx(v,{title:n,description:x,setTitle:h,setDescription:u,addTask:j}),e.jsx("div",{className:"tasks",children:i.length===0?e.jsx("p",{className:"dtask",children:"No hay tareas disponibles"}):i.slice().reverse().map(t=>t&&e.jsx(k,{title:t.title,description:t.description,id:t._id,onDelete:g,onUpdate:m},t._id))})]})})}export{N as default};
